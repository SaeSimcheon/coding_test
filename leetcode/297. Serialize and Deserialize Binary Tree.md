## 221224
# Definition for a binary tree node.
# class TreeNode(object):
#     def __init__(self, x):
#         self.val = x
#         self.left = None
#         self.right = None
# level 단위로 입력 -> level에 맞지만 데이터가 존재하지 않는 경우 None으로 전부 채우려고 했는데 -> 시간이 초과함.
# 이해를 잘못했던 부분이 있었는데, None으로 최초로 발견되면 이후는 그냥 생략하는 것이 맞는 것 같음.
# perfect binary tree 꼴로 만든 다음에 index index*2+1 , index*2+2 로 해결하려 했는데 testcase 51에서 시간 초과가 발생


from collections import deque
class Codec:

    def serialize(self, root):
        
        Q = deque([root])
        flag = True
        out = deque([])
        print(root)
        while flag :
            flag = False
            length = len(Q)
            for _ in range(length):
                this = Q.popleft()
                if this is not None :
                    out.append(this.val)
                    if this.left is not None or  this.right is not None :
                        flag = True
                    Q.append(this.left)
                    Q.append(this.right)
                else:
                    out.append(None)
                    Q.append(None)
                    Q.append(None)
        print(out)
        return ' '.join(map(str,out))
    
    def deserialize(self, data):

        data= deque(data.split())
        
        def _inner(index):
            if index >= len(data):
                return
            v = data[index]
            v = (None if v == 'None'  else int(v))

            if v is not None :
                node = TreeNode(v)                
                
                node.left = _inner(index*2+1)
                node.right = _inner(index*2+2)    
                return node
            else:
                return None
        a=_inner(0)
        
        return a
        

# Your Codec object will be instantiated and called as such:
# ser = Codec()
# deser = Codec()
# ans = deser.deserialize(ser.serialize(root))


